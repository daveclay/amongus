(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{28:function(e,n,t){},29:function(e,n,t){"use strict";t.r(n);var r=t(1),a=(t(0),t(5)),c=t.n(a),o=t(3),u=t(4),i=t(11),l=t(2),s=function(e,n){return n.playerNames.map((function(n){return m(e,n)}))},m=function(e,n){return e.find((function(e){return e.name===n}))},d=function(e){return e.players[e.currentTurnPlayerIndex]},y=function(e){var n=d(e);return n?n.name:null},f=function(e,n){return y(e)===n.name},p=function(e,n){return e.rooms.find((function(e){return b(e,n)}))},b=function(e,n){return e.playerNames.includes(n.name)},j=function(e,n){var t=d(e);if(t){var r=p(e,t);return r&&r.name===n.name}return!1},g=function(e,n){var t=d(e);return t&&!j(e,n)&&!e.gameOver&&!e.emergencyMeetingStarted&&t.human},v=function(e){var n=d(e);if(n){var t=p(e,n);return n&&n.human&&!e.gameOver&&t.emergencyButton}return!1},O=function(e,n){return e.tasks.find((function(e){return e.id===n.taskId}))},h=function(e,n){return e.tasks.find((function(e){return e.id===n}))},N=function(e,n){var t=k(e,n);return j(e,t)&&null==n.playerName&&!e.emergencyMeetingStarted&&!n.completed&&d(e).human},P=function(e,n){return j(e,n)&&d(e).human},k=function(e,n){return e.rooms.find((function(e){return e.taskId===n.id}))},x=function(e){var n=e.currentTurnPlayerIndex+1;return e.players.length===n?0:n},I=function(e,n){return e[1]>n[1]?-1:1},T=t(16),C=t(12),M={clone:function(e){return Object(T.a)(e)},allExcept:function(e,n){return e.filter((function(e){return e!==n}))},pluckRandom:function(e){return 0===e.length?null:e.splice(M.sampleIndex(e),1)[0]},sampleIndex:function(e){return Math.floor(Math.random()*e.length)},sample:function(e){return e[M.sampleIndex(e)]}},S=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return t.reduce((function(e,n){return n(e)}),e)},E=function(e){return function(n,t){return Object(C.a)(n,(function(n){return e(n,t)}))}},R=function(){return{type:"init"}},F=function(e){return{type:"updatePlayerName",name:e}},B=function(){return{type:"addHumanPlayer",player:{human:!0}}},A=function(){return{type:"addComputerPlayer",player:{human:!1}}},w=function(){return{type:"nextPlayerTurn"}},H=function(){return function(e,n){e({type:"startGame"}),Q(e,n)}},V=function(){return{type:"enableComputerPlayers"}},G=function(e){return function(n,t){n({type:"onRoomSelected",roomName:e}),Q(n,t)}},J=function(e){return function(n,t){n({type:"onTaskSelected",taskId:e}),Q(n,t)}},D=function(){return{type:"onEmergencyMeetingSelected"}},U=function(){return function(e,n){Q(e,n)}},W=function(e){return function(n,t){n({type:"voteImposter",playerName:e}),Q(n,t)}},X=function(e){return{type:"votedOffImposter",voteResults:e}},z=function(e){return{type:"votedTie",voteResults:e}},K=function(e){return{type:"voteFailed",voteResults:e}},q=function(){return{type:"emergencyMeetingFinished"}},L=function(){return{type:"allTasksCompleted"}},Q=function(e,n){new function(e){this.then=function(n){e(n)}}((function(t){if(function(e){if(e.emergencyMeetingStarted){var n=e.emergencyMeetingInitiatedByPlayerIndex-1;return n<0&&(n=e.players.length-1),e.currentTurnPlayerIndex===n}}(n())){var r=function(e){var n=Object.entries(e.voteTalliesByPlayer).sort(I),t=n[0],r=n[1],a={playerName:t[0],votes:t[1]},c={playerName:r[0],votes:r[1]},o=function(e){return{mostVoted:a,secondMostVoted:c,results:e}};return a.votes===c.votes?o({victory:!1,tie:!0}):a.playerName===e.imposterPlayerName?o({victory:!0}):o({victory:!1})}(n());r.results.victory?e(X(r)):(r.results.tie?e(z(r)):e(K(r)),setTimeout((function(){return t()}),3e3)),e({type:"emergencyMeetingFinished"})}else 0===n().tasks.filter((function(e){return!e.completed})).length?e({type:"allTasksCompleted"}):t()})).then((function(){e({type:"nextPlayerTurn"});var t=n(),r=d(t);console.log("XXX",r),!r.human&&t.computerPlayersEnabled&&Y(e,n)}))},Y=function(e,n){setTimeout((function(){var t=M.sample(Z(n));e(t)}),200)},Z=function(e){return e().emergencyMeetingStarted?[$]:_},$=function(e,n){var t=n();Math.random()>.5?e(W(M.sample(t.players).name)):e(U())},_=[function(e,n){var t=n(),r=M.sample(t.rooms);e(G(r.name))},function(e,n){var t=n(),r=d(t),a=p(t,r),c=O(t,a);e(J(c.id))}],ee=t(13),ne=t(14),te=new(function(){function e(){Object(ee.a)(this,e),this.actionsToReducers={},this.initialState={}}return Object(ne.a)(e,[{key:"map",value:function(e,n){var t="function"===typeof e?e.name:e;this.actionsToReducers[t]||(this.actionsToReducers[t]=[]);var r=this.actionsToReducers[t];r[r.length]=n}},{key:"reduce",value:function(e,n){return this.getReducersForAction(n).reduce((function(e,t){return t(e,n)}),e)}},{key:"getReducersForAction",value:function(e){var n=e.type,t=this.actionsToReducers[n];return t||(console.log("No reducer found for ".concat(n)),[])}}]),e}()),re=function(e,n){te.map(e,n)};var ae=function(e){e.rooms.forEach((function(e){return e.playerNames=[]})),e.players.forEach((function(n){return ce(e,n,"Cafeteria")}))},ce=function(e,n,t){oe(e,n.name);var r=function(e,n){return e.rooms.find((function(e){return e.name===n}))}(e,t);r.playerNames[r.playerNames.length]=n.name},oe=function(e,n){e.rooms.forEach((function(e){e.playerNames=M.allExcept(e.playerNames,n)}))},ue=function(e){var n=d(e),t=p(e,n),r=h(e,t.taskId);(function(e,n){return n.playerName===e.name})(n,r)&&(!function(e,n){return e.imposterPlayerName===n.name}(e,n)?r.completed=!0:!function(e,n){return 1===e.playerNames.length&&e.playerNames[0]===n.name}(t,n)?r.compelted=!0:(console.log("".concat(n.name," sabotaged ").concat(r.description)),r.completed=!1),r.playerName=null)},ie=function(e){ae(e),function(e){e.tasks.forEach((function(e){return e.playerName=null}))}(e),e.emergencyMeetingStarted=!0,e.emergencyMeetingInitiatedByPlayerIndex=e.currentTurnPlayerIndex,le(e),e.notify={message:"Emergency Meeting!",className:"emergencyMeeting"}},le=function(e){e.players.forEach((function(n){return e.voteTalliesByPlayer[n.name]=0}))},se=function(e,n){return S(e,E((function(e){return function(e,n){if(0===e.addPlayerForm.name.length)return e;var t=Object(l.a)(Object(l.a)({},n.player),{},{name:e.addPlayerForm.name,image:M.pluckRandom(e.availablePlayerImages)});e.players[e.players.length]=t,ce(e,t,"Cafeteria"),e.addPlayerForm.name=""}(e,n)})))};re(R,(function(e){return S(e,ye,fe)})),re(H,(function(e){return S(e,(function(e){return Object(l.a)(Object(l.a)({},e),{},{gameOver:!1,victory:!1})}),de,me,E(ae))})),re(V,(function(e){return Object(l.a)(Object(l.a)({},e),{},{computerPlayersEnabled:!0})})),re(F,(function(e,n){return Object(l.a)(Object(l.a)({},e),{},{addPlayerForm:{name:n.name}})})),re(B,se),re(A,se),re(G,(function(e,n){return S(e,E((function(e){return function(e,n){var t=d(e);t&&ce(e,t,n)}(e,n.roomName)})))})),re(J,(function(e,n){return S(e,E((function(e){return function(e,n){var t=d(e);n===p(e,t).taskId&&(h(e,n).playerName=t.name)}(e,n.taskId)})))})),re(w,(function(e){return S(e,(function(e){return Object(l.a)(Object(l.a)({},e),{},{currentTurnPlayerIndex:x(e)})}),E(ue),pe)})),re(D,(function(e){return S(e,E(ie))})),re(W,(function(e,n){return S(e,E((function(e){return function(e,n){e.voteTalliesByPlayer[n]+=1}(e,n.playerName)})))})),re(X,(function(e,n){return Object(l.a)(Object(l.a)({},e),{},{gameOver:!0,notify:{message:"Victory! ".concat(n.voteResults.mostVoted.playerName," was the imposter!"),className:"victory"}})})),re(z,(function(e){return Object(l.a)(Object(l.a)({},e),{},{notify:{message:"Tie! No one was ejected.",className:"alert"}})})),re(K,(function(e,n){return Object(l.a)(Object(l.a)({},e),{},{notify:{message:"".concat(n.voteResults.mostVoted.playerName," was NOT the imposter!"),className:"alert"}})})),re(q,(function(e){return Object(l.a)(Object(l.a)({},e),{},{emergencyMeetingStarted:!1,emergencyMeetingInitiatedByPlayerIndex:null})})),re(L,(function(e){return Object(l.a)(Object(l.a)({},e),{},{gameOver:!0,notify:{message:"All tasks were completed! The Crewmates Win!",className:"victory"}})}));var me=function(e){return Object(l.a)(Object(l.a)({},e),{},{imposterPlayerName:M.sample(e.players).name})},de=function(e){return Object(l.a)(Object(l.a)({},e),{},{currentTurnPlayerIndex:-1})},ye=function(e){return Object(l.a)(Object(l.a)({},e),{},{availableComputerPlayers:M.clone(e.computerPlayers)})},fe=function(e){return Object(l.a)(Object(l.a)({},e),{},{availablePlayerImages:M.clone(e.playerImages)})},pe=function(e){return Object(l.a)(Object(l.a)({},e),{},{notify:{message:"".concat(y(e),"'s turn!"),className:"turn"}})},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.initialState,n=arguments.length>1?arguments[1]:void 0;return te.reduce(e,n)},je=t(15),ge=Object(u.applyMiddleware)(i.a),ve=Object(u.createStore)(be,{gameOver:!1,notify:{message:null},computerPlayersEnabled:!1,currentTurnPlayerIndex:-1,emergencyMeetingStarted:!1,emergencyMeetingInitiatedByPlayerIndex:null,voteTalliesByPlayer:{},computerPlayers:["Funk","Foo","Grandpop","Grandma","Preston","Mouth","Crayon"],availableComputerPlayers:[],playerImages:["blue","darkgreen","green","lightblue","orange","pink","red","white"],availablePlayerImages:[],addPlayerForm:{name:""},players:[],tasks:[{id:1,description:"Fix wiring",completed:!1,playerName:null},{id:2,description:"Unlock manifolds",completed:!1,playerName:null},{id:3,description:"Swipe card",completed:!1,playerName:null},{id:4,description:"Stabilize steering",completed:!1,playerName:null},{id:5,description:"Destroy asteroids",completed:!1,playerName:null},{id:6,description:"Fill the fuel tank",completed:!1,playerName:null}],rooms:[{name:"Cafeteria",taskId:1,playerNames:[],emergencyButton:!0},{name:"Reactor",taskId:2,playerNames:[]},{name:"Admin",taskId:3,playerNames:[]},{name:"Navigation",taskId:4,playerNames:[]},{name:"Weapons",taskId:5,playerNames:[]},{name:"Engine",taskId:6,playerNames:[]}]},Object(je.composeWithDevTools)(ge));ve.dispatch({type:"init"});var Oe=ve,he=(t(28),Object(o.b)((function(e){return{notify:e.notify}}))((function(e){var n=e.notify;return null==n.message?"<div/>":Object(r.jsx)("div",{id:"notify",className:n.className,children:n.message})}))),Ne=Object(o.b)((function(e){return{addPlayerForm:e.addPlayerForm}}),{updatePlayerName:F,addHumanPlayer:B,addComputerPlayer:A,startGame:H})((function(e){var n=e.addPlayerForm,t=e.updatePlayerName,a=e.addHumanPlayer,c=e.addComputerPlayer,o=e.startGame;return Object(r.jsxs)("div",{className:"header",children:[Object(r.jsx)("div",{className:"title",children:"AMONG US"}),Object(r.jsxs)("div",{className:"gameControls",children:[Object(r.jsxs)("div",{className:"addHumanPlayer",children:[Object(r.jsx)("input",{id:"playerName",placeholder:"Player Name",value:n.name,onKeyUp:function(e){"Enter"===e.code&&a()},onChange:function(e){t(e.target.value)}}),Object(r.jsx)("button",{id:"addHumanPlayer",onClick:function(){return a()},children:"Add Human Player"})]}),Object(r.jsx)("button",{id:"addComputerPlayer",onClick:function(){return c()},children:"Add Computer Player"}),"|",Object(r.jsx)("button",{id:"startButton",onClick:function(){return o()},children:"Start!"})]}),Object(r.jsx)(he,{})]})})),Pe=Object(o.b)((function(e,n){return Object(l.a)(Object(l.a)({},n),{},{celebrate:e.gameOver,isCurrentTurn:f(e,n.player),votingEnabled:e.emergencyMeetingStarted})}),{skipVote:U,voteImposter:W})((function(e){var n=e.celebrate,t=e.player,a=e.isCurrentTurn,c=e.votingEnabled,o=e.skipVote,u=e.voteImposter;return Object(r.jsx)("div",{className:"player ".concat(a||n?"turnHighlight":""),children:Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"imageContainer",children:Object(r.jsx)("img",{src:"character-images/".concat(t.image,".png")})}),Object(r.jsxs)("div",{className:"playerContent",children:[Object(r.jsx)("span",{className:"playerName",children:t.name}),Object(r.jsx)("span",{className:"status",children:a?"'s turn!":""}),Object(r.jsx)("div",{children:c?a?Object(r.jsx)("button",{className:"skipButton",onClick:function(){return o()},children:"Skip"}):Object(r.jsx)("button",{className:"voteButton",onClick:function(){return u(t.name)},children:"Vote"}):null})]})]})})})),ke=Object(o.b)((function(e,n){return Object(l.a)(Object(l.a)({},n),{},{isCurrentTurnPlayerHumanAndInRoom:P(e,k(e,n.task)),currentTurnPlayerAbleToPerformTask:N(e,n.task)})}),{onTaskSelected:J})((function(e){var n=e.task,t=e.currentTurnPlayerAbleToPerformTask,a=e.isCurrentTurnPlayerHumanAndInRoom,c=e.onTaskSelected;return Object(r.jsx)("div",{className:"task ".concat(t?"selectable":""),onClick:function(e){t&&c(n.id),e.stopPropagation()},children:Object(r.jsx)("div",{className:"description",children:n.playerName?"".concat(n.playerName," is performing ").concat(n.description):n.completed&&a?"".concat(n.description," completed"):n.description})})})),xe=Object(o.b)((function(e){return{emergencyMeetingStarted:e.emergencyMeetingStarted,emergencyMeetingButtonEnabled:v(e)}}),{onEmergencyMeetingSelected:D})((function(e){var n=e.emergencyMeetingButtonEnabled,t=e.emergencyMeetingStarted,a=e.onEmergencyMeetingSelected;return Object(r.jsx)("button",{disabled:!n,onClick:function(){t||a()},id:"emergencyMeetingButton",children:"Emergency Meeting!"})})),Ie=Object(o.b)((function(e,n){return{room:n.room,players:e.players,task:O(e,n.room),currentTurnPlayerAbleToSelectRoom:g(e,n.room)}}),{onRoomSelected:G})((function(e){var n=e.room,t=e.players,a=e.task,c=e.currentTurnPlayerAbleToSelectRoom,o=e.onRoomSelected;return Object(r.jsxs)("div",{className:"room",onClick:function(){c&&o(n.name)},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"roomName",children:n.name}),Object(r.jsx)("div",{className:"taskContainer",children:Object(r.jsx)(ke,{task:a})}),n.emergencyButton?Object(r.jsx)(xe,{}):null]}),Object(r.jsx)("div",{className:"players",children:s(t,n).map((function(e){return Object(r.jsx)(Pe,{player:e},e.name)}))})]})})),Te=Object(o.b)((function(e){return{rooms:e.rooms}}))((function(e){var n=e.rooms;return Object(r.jsx)("div",{children:n.map((function(e){return Object(r.jsx)(Ie,{room:e},e.name)}))})}));var Ce=function(){return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(Ne,{}),Object(r.jsx)(Te,{})]})},Me=document.getElementById("root");c.a.render(Object(r.jsx)(o.a,{store:Oe,children:Object(r.jsx)(Ce,{})}),Me);var Se=[function(){return F("Jackson")},function(){return{type:"addHumanPlayer",player:{human:!0}}},function(){return F("Daddy")},function(){return{type:"addHumanPlayer",player:{human:!0}}},function(){return F("Foo")},function(){return{type:"addComputerPlayer",player:{human:!1}}},function(){return F("Baz")},function(){return{type:"addComputerPlayer",player:{human:!1}}},function(){return H()},function(){return J(1)},function(){return G("Reactor")},function(){return G("Navigation")},function(){return J(3)},function(){return{type:"onEmergencyMeetingSelected"}},function(){return W("Foo")},function(){return W("Foo")},function(){return U()},function(){return W("Jackson")},function(){return{type:"enableComputerPlayers"}}],Ee=0,Re=setInterval((function(){return console.log(Se[Ee]),Oe.dispatch(Se[Ee]()),void(++Ee===Se.length&&clearInterval(Re))}),100)}},[[29,1,2]]]);
//# sourceMappingURL=main.c59e6a90.chunk.js.map